---
title: Linux shell 如何提取文件名和文件目录
date: 2016-09-03 00:20:08
tags: [shell, 提取文件名, 提取目录名, linux]
categories: shell
---

很多时候在使用Linux的shell时，我们都需要对文件名或目录名进行处理，通常的操作是由路径中提取出文件名，从路径中提取出目录名，提取文件后缀名等等。例如，从路径`/dir1/dir2/file.txt`中提取也文件名`file.txt`，提取出目录`/dir1/dir2`，提取出文件后缀`txt`等。

下面介绍两种常用的方法来进行相关的操作。

## 1. 使用`${}`

### 1.1. 提取文件名`${var##*/}`
该命令的作用是去掉变量`var`从左边算起的最后一个`/`字符及其左边的内容，返回从左边算起的最后一个`/`（不含该字符）的右边的内容。使用例子及结果如下：

```shell
taolin@pc:~$ var=/dir1/dir2/file.txt
taolin@pc:~$ echo ${var##*/}
file.txt
```

从运行结果可以看到，使用该命令，可以提取出我们需要的文件名`file.txt`。

若使用时在shell程序文件中，可以使用变量来保存这个结果，再加以利用，如`file=${var##*/}`

### 1.2. 提取文件后缀`${var##*.}`
该命令的作用是去掉变量`var`从左边算起的最后一个`.`字符及其左边的内容，返回从左边算起的最后一个`.`（不含该字符）的右边的内容。使用例子及结果如下：

```shell
taolin@pc:~$ var=/dir1/dir2/file.txt
taolin@pc:~$ echo ${var##*.}
txt
```

从运行结果可以看到，使用该命令，可以提取出我们需要的文件后缀。

如果文件的后缀不仅有一个，例如，`file.tar.gz`，命令`${var##*.}`仅能提取最后一个后缀，而我想提取`tar.gz`时该怎么办？那么就要用下面所说的`${var#*.}`命令了。
<!-- more -->

### 1.3. 提取多个文件后缀`${var#*.}`
该命令的作用是去掉变量`var`从左边算起的第一个`.`字符及其左边的内容，返回从左边算起第一个`.`（不含该字符）的右边部分的内容。使用例子及结果如下：

```shell
taolin@pc:~$ var=/dir1/dir2/file.tar.gz
taolin@pc:~$ echo ${var#*.}
tar.gz
```

从运行结果可以看到，使用该命令，可以提取出文件的多个后缀。

### 1.4. 提取文件目录`${var%/*}`
该命令的使用是去掉变量`var`从右边算起的第一个`/`字符及其右边的内容，返回从右边算起的第一个`/`（不含该字符）的左边的内容。使用例子及结果如下：

```shell
taolin@pc:~$ var=/dir1/dir2/file.txt
taolin@pc:~$ echo ${var%/*}
/dir1/dir2
```

从运行的结果可以看到，使用该命令，可以提取出我们需要的文件所在的目录

### 1.5. 去掉文件后缀`${var%%.*}`
该命令的使用是去掉变量`var`从右边算起的最后一个`.`字符及其右边的内容，返回从右边算起的最后一个`.`（不含该字符）的左边的内容。使用例子及结果如下：

```shell
taolin@pc:~$ var=/dir1/dir2/file.txt
taolin@pc:~$ echo ${var%%.*}
/dir1/dir2/file
```

当我们需要建立一个与文件名相同名字（没有后缀）的目录与对应的文件相对应时，就可以使用该命令来进行操作。例如，解压文件的情况就与此类似，我们压缩文件file.zip时，会在与file.zip同级目录下建立一个名为file的目录。

### 1.6. `${}`总结
其实`${}`并不是专门为提取文件名或目录名的，它的使用是变量的提取和替换等等操作，它可以提取非常多的内容，并不一定是上面五个例子中的`/`或`.`。也就是说，上面的使用方法只是它使用的一个特例。

看到上面的这些命令，可能会让人感到非常难以理解和记忆，其实不然，它们都是有规律的。
 
- `#`  &nbsp;&nbsp; 表示从左边算起第一个
- `%`  &nbsp;&nbsp; 表示从右边算起第一个
- `##` &nbsp;&nbsp; 表示从左边算起最后一个
- `%%`  &nbsp;&nbsp; 表示从右边算起最后一个

换句话来说，＃总是表示左边算起，％总是表示右边算起。

- `＊`  &nbsp;&nbsp; 表示要删除的内容，对于`#`和`##`的情况，它位于指定的字符（例子中的`/`和`.`）的左边，表于删除指定字符及其左边的内容；对于`%`和`%%`的情况，它位于指定的字符（例子中的`/`和`.`）的右边，表示删除指定字符及其右边的内容。这里的`*`的位置不能互换，即不能把`*`号放在`#`或`##`的右边，反之亦然。

例如：`${var%%x*}`表示找出从右边算起最后一个字符`x`，并删除字符`x`及其右边的字符。

看到这里，就可以知道，其实该命令的用途非常广泛，上面只是指针文件名和目录名的命名特性来进行提取的一些特例而已。

## 2. basename和dirname

`${}`并不是专门为提取文件名和目录名设计的命令，那么`basename`和`dirname`命令就是专门为做这一件事而已准备的了。

### 2.1. 提取文件名basename
该命令的作用是从路径中提取出文件名，使用方法为`basename NAME [SUFFIX]`。

1）从路径中提出出文件名（带后缀），例子如下：

```shell
taolin@pc:~$ var=/dir1/dir2/file.txt
taolin@pc:~$ echo $(basename $var)
file.txt
```

2）从上面命令的用法中可以看到，后缀（SUFFIX）是一个可选项。所以，若只想提取出文件名`file`，而不带有后缀，还可以在变量的后面加上后缀名，例子如下：

```shell
taolin@pc:~$ var=/dir1/dir2/file.txt
taolin@pc:~$ echo $(basename $var .txt)
file
```

### 2.2. 提取目录名dirname
该命令的作用是从路径中提取出目录名，使用方法为`dirname NAME`
使用例子如下：

```shell
taolin@pc:~$ var=/dir1/dir2/file.txt
taolin@pc:~$ dirname $var
/dir1/dir2
```

这样就提取出了`file.txt`文件所在的目录。

注：该命令不仅能提取出普通文件所的目录，它能提取出任何文件所在的目录，例如目录所在的目录，如下：

```shell
taolin@pc:~$ var=/dir1/dir2/
taolin@pc:~$ dirname $var
/dir1
```

它提取出了目录`dir2`所在的目录`dir1`。

本文转载自：http://blog.csdn.net/ljianhui/article/details/43128465
